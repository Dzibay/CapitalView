<script setup>
import { computed } from 'vue';

const props = defineProps({
  totalAmount: { type: Number, required: true },
  investedAmount: { type: Number, required: true },
  monthlyChange: { type: Object, required: true },
});

const formattedTotalAmount = computed(() => {
  return new Intl.NumberFormat('ru-RU', { style: 'currency', currency: 'RUB' }).format(props.totalAmount);
});
const formattedInvestedAmount = computed(() => {
  return new Intl.NumberFormat('ru-RU', { style: 'currency', currency: 'RUB' }).format(props.investedAmount);
});

const isPositiveChange = computed(() => {
  return props.monthlyChange.absolute >= 0
});

</script>

<template>
  <div class="widget">

    <div class="widget-title">

      <div class="widget-title-icon-rect">
        <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="none" viewBox="0 0 15 15">
          <g clip-path="url(#a)">
            <path fill="#000" d="m5.961-.009.114-.001a91 91 0 0 1 .518-.002l.34-.003a27.215 27.215 0 0 1 .387-.002c.282-.004.523.015.735.217.076.084.128.167.177.269h.081a36.34 36.34 0 0 1 .432.008c.39.004.688.052.977.333.197.214.298.46.31.752-.015.365-.188.681-.357.996a101.114 101.114 0 0 0-.212.401l.065.01c.251.041.412.112.59.296.144.227.167.42.136.69a.83.83 0 0 1-.352.469l-.058.03.09.071c.712.572 1.28 1.19 1.697 2.008l.032.063c.215.428.378.871.506 1.332l.022.08.021.077.018.067c.023.114.034.229.045.344a166.516 166.516 0 0 1 1.28-.011l.106-.002c.244 0 .433.033.623.193a64.965 64.965 0 0 1 .112.13c.1.148.113.284.111.46v.108c-.005.089-.005.089-.034.147l.073.017a.8.8 0 0 1 .436.409.978.978 0 0 1-.083.744.817.817 0 0 1-.397.295v.528l.12.058c.192.106.31.262.378.469.03.263.012.486-.146.703a.694.694 0 0 1-.381.235l.029.058c.003.068.004.136.004.203v.111c-.004.096-.004.096-.033.184l.06.006c.197.054.309.177.41.35.095.187.09.454.038.655a.85.85 0 0 1-.45.435.905.905 0 0 1-.295.03h-.932l-.498.001a396.582 396.582 0 0 1-1.768 0l-.114.001H6.7a1698.972 1698.972 0 0 1-4.241.002 115.49 115.49 0 0 0-.944 0h-.163c-.41.002-.752-.034-1.059-.337-.262-.308-.324-.6-.3-.996.03-.285.184-.521.398-.704.23-.17.442-.23.722-.263a64.53 64.53 0 0 1-.042-.3l-.012-.085-.012-.084-.01-.077a7.277 7.277 0 0 1-.047-.804v-.1a72.518 72.518 0 0 1-.001-.425c0-.562.016-1.113.095-1.67l.015-.109c.17-1.161.512-2.333 1.215-3.29l.035-.049A4.862 4.862 0 0 1 3.553 4.54c.081-.048.081-.048.11-.115L3.6 4.407c-.168-.083-.284-.25-.348-.423a.88.88 0 0 1 .11-.683.79.79 0 0 1 .476-.313h.205l-.045-.087a96.07 96.07 0 0 1-.338-.668l-.033-.062a1.267 1.267 0 0 1-.118-.884c.105-.305.278-.549.569-.697a.948.948 0 0 1 .47-.093 42.366 42.366 0 0 0 .32 0c.248.015.248.015.464-.079.036-.06.062-.118.088-.184.054-.059.054-.059.102-.099l.049-.04a.645.645 0 0 1 .39-.104Zm-.14.602a.348.348 0 0 0-.064.224v.56l-.001.386v.09c0 .13 0 .206-.07.319-.066.059-.09.074-.178.071h-.059c-.088-.025-.12-.06-.176-.134a1.716 1.716 0 0 1-.017-.248l-.002-.073a21.193 21.193 0 0 1-.005-.383 44.474 44.474 0 0 1-.005-.38 33.104 33.104 0 0 0-.397-.007l-.114-.003c-.24-.002-.381.009-.564.172-.126.16-.175.278-.155.483.08.257.216.499.337.739a73.145 73.145 0 0 1 .17.34l.032.062a.643.643 0 0 0 .105.177 3.07 3.07 0 0 0 .27.004h.118a170.404 170.404 0 0 1 .461 0l.352-.001a706.28 706.28 0 0 0 1.426-.001l1.563-.002.034-.069.239-.477a99.966 99.966 0 0 0 .195-.388l.028-.056.078-.152a.621.621 0 0 0 .04-.475.683.683 0 0 0-.38-.346c-.09-.008-.09-.008-.19-.005H8.78l-.115.002h-.117l-.286.003-.001.098a43.855 43.855 0 0 1-.007.514c0 .075-.002.15-.004.224v.07c-.003.105-.008.166-.074.252-.103.074-.17.057-.295.044a.318.318 0 0 1-.117-.147 2.207 2.207 0 0 1-.004-.133v-.175a171.365 171.365 0 0 0-.004-.49c0-.096 0-.192-.002-.288v-.09a.601.601 0 0 0-.07-.322C7.53.495 7.379.506 7.206.508a3375.796 3375.796 0 0 0-.349 0h-.59l-.11-.001-.101.001h-.09c-.083.014-.083.014-.145.085Zm-2.042 3.04c-.022.057-.022.057-.018.117l-.001.059c.03.093.084.123.166.175.08.012.15.016.231.015l.07.001h.399l.452.001h1.267l.918.001a201.065 201.065 0 0 0 1.259.001 52.248 52.248 0 0 0 .605 0h.287a.339.339 0 0 0 .253-.088c.065-.073.065-.073.078-.165-.025-.12-.07-.159-.165-.234a1.148 1.148 0 0 0-.231-.019H7.955l-.794.001h-.918a270.805 270.805 0 0 0-1.702.002h-.449a.379.379 0 0 0-.313.133Zm.323 1.172-.144.096a5.878 5.878 0 0 0-.163.126 5.83 5.83 0 0 0-.455.393c-.026.025-.052.05-.08.074-1.258 1.217-1.707 3.134-1.74 4.832-.003.187-.004.375-.004.563v.1c0 .597.03 1.17.154 1.755l.084.001a40.019 40.019 0 0 1 .444.007c.064 0 .129.002.193.004l.117.001c.113.019.149.043.217.134a.607.607 0 0 1-.03.322c-.09.035-.18.033-.274.033l-.096.001h-.103a155.63 155.63 0 0 0-.556.005 44.953 44.953 0 0 0-.43.002c-.225.004-.397.03-.564.194l-.04.06-.042.06c-.086.145-.078.302-.063.465.053.197.181.309.352.41.089.03.147.033.24.033h1.534a773.916 773.916 0 0 1 2.188-.001h1.804l3.375-.002.008-.243.003-.07a.834.834 0 0 0-.011-.185.567.567 0 0 0-.217-.137c-.15-.077-.23-.235-.282-.39-.02-.234-.02-.448.118-.645a.905.905 0 0 1 .38-.264c.03-.28.03-.28 0-.557a.638.638 0 0 0-.24-.163c-.122-.062-.176-.153-.228-.276a.947.947 0 0 1 .058-.703c.105-.159.243-.239.41-.322V9.96l-.234-.117a.752.752 0 0 1-.274-.498c-.01-.248.032-.444.199-.634.22-.2.448-.2.73-.202l.114-.001.297-.003.303-.004.594-.006c-.193-.863-.48-1.678-.996-2.402l-.039-.054a4.87 4.87 0 0 0-1.151-1.127 6.433 6.433 0 0 1-.133-.097c-.459-.338-.907-.356-1.455-.35-.116.002-.231 0-.347 0l-.582.003c-.223.002-.446.002-.67 0l-.649.001h-.273c-.511-.003-.93.015-1.351.335Zm5.97 4.287c-.057.075-.057.075-.073.166.023.099.057.141.136.203.127.065.27.05.409.05h.106l.286-.001h.3l.504-.002.582-.001a137.915 137.915 0 0 0 1.132-.003h.271a.465.465 0 0 0 .22-.1c.046-.091.04-.162.03-.263a.303.303 0 0 0-.218-.128 4.933 4.933 0 0 0-.28-.005l-.107-.001a34.968 34.968 0 0 0-.535 0h-.575l-.592-.001a83.04 83.04 0 0 0-.813-.002h-.44c-.184.001-.184.001-.343.088Zm.498.996c-.064.096-.074.141-.052.254a.482.482 0 0 0 .175.146 2.518 2.518 0 0 0 .235.005h.206l.288.001h.18a351.522 351.522 0 0 0 1.212.003 140.045 140.045 0 0 0 1.136.002h.273a.46.46 0 0 0 .22-.099c.046-.091.04-.162.03-.263a.304.304 0 0 0-.218-.128 4.986 4.986 0 0 0-.28-.005h-.107a40.441 40.441 0 0 0-.535-.002h-1.167a78.54 78.54 0 0 0-.813-.002l-.338.001-.102-.001c-.184.001-.184.001-.343.088Zm-.498.997c-.058.074-.058.074-.07.165.025.124.061.159.164.234.117.023.232.02.35.02h1.81a78.54 78.54 0 0 0 .813 0 29.44 29.44 0 0 0 .44 0c.184-.001.184-.001.343-.089.058-.074.058-.074.07-.165-.025-.124-.061-.159-.164-.234-.117-.023-.232-.02-.35-.02h-1.81a78.51 78.51 0 0 0-.813 0h-.44c-.184.001-.184.001-.343.089Zm.504.985c-.069.103-.075.143-.058.264.05.085.05.085.146.146.117.022.232.02.35.019h.705l.513-.001h.592a108.456 108.456 0 0 0 1.152-.002h.101c.18-.001.18-.001.343-.069.062-.063.062-.063.067-.166-.015-.105-.027-.148-.102-.22a.65.65 0 0 0-.235-.033h-.192a1323.3 1323.3 0 0 0-.394-.001h-.807a227.995 227.995 0 0 1-1.087-.002 99.934 99.934 0 0 1-.634 0h-.272a.37.37 0 0 0-.188.065Zm-.556 1.084c-.027.088-.027.088 0 .176.05.085.05.085.146.147.117.022.232.02.35.018a629.168 629.168 0 0 0 .4 0h.817c.197-.002.395-.002.592-.001a108.452 108.452 0 0 0 1.152-.002h.101c.18-.001.18-.001.343-.069.061-.063.061-.063.07-.166-.02-.116-.043-.15-.135-.22-.072-.036-.12-.033-.2-.034h-.192L13.357 13h-.466l-.497-.002a141.257 141.257 0 0 1-1.215-.005c-.1 0-.2 0-.3-.002h-.334l-.1-.002c-.193.002-.296.016-.425.165Zm.556.938c-.069.084-.069.084-.055.19.016.102.016.102.076.152.08.046.129.05.22.05h.197l.109.001a48.175 48.175 0 0 0 .54 0h.58a125.808 125.808 0 0 0 1.762.002l.103.001h.176c.095-.02.13-.057.189-.133.02-.102.02-.102 0-.205a.463.463 0 0 0-.176-.146 2.483 2.483 0 0 0-.142-.004h-.19l-.105-.001-.286-.001h-.178a345.92 345.92 0 0 0-1.203-.003 165.204 165.204 0 0 0-1.127-.002h-.27a.451.451 0 0 0-.22.099Z"/>
            <path fill="#000" d="M6.855 6.24c.087.066.087.066.147.147v.117l.064.012c.38.081.697.265.923.585.196.313.318.64.273 1.014-.06.095-.06.095-.147.147a.404.404 0 0 1-.287-.04c-.08-.096-.089-.168-.108-.289-.05-.268-.156-.517-.373-.69a1.653 1.653 0 0 0-.345-.182v1.962l.234.03c.43.164.72.425.917.841.156.372.16.801.02 1.18a1.541 1.541 0 0 1-.876.85.735.735 0 0 1-.295.058l.007.066c-.007.08-.007.08-.055.147a.354.354 0 0 1-.245.08c-.095-.029-.095-.029-.176-.088-.04-.107-.04-.107-.058-.205l-.053-.006a1.374 1.374 0 0 1-.884-.539c-.178-.268-.297-.537-.303-.86l-.003-.109c.012-.097.012-.097.066-.167a.343.343 0 0 1 .24-.076c.155.056.155.056.208.138.032.083.04.16.05.248a.996.996 0 0 0 .18.463l.05.079c.124.124.283.217.449.273V9.492l-.264-.058c-.41-.165-.682-.444-.869-.837a1.665 1.665 0 0 1-.02-1.157c.186-.415.472-.696.889-.878.073-.019.073-.019.135-.03.107-.018.107-.018.15-.114l.037-.09c.097-.103.185-.107.322-.088Zm-.8 1.055c-.2.21-.287.43-.298.72.012.3.118.494.323.71.106.095.246.21.395.21V7.062c-.153 0-.31.138-.42.234Zm.947 2.256v1.904c.345-.153.57-.33.714-.685a1.127 1.127 0 0 0-.142-.823.967.967 0 0 0-.572-.396Z"/>
          </g>
        </svg>
      </div>

      <h2 class="widget-title">Общий капитал</h2>
      
    </div>

    <div class="capital-value-with-change">
      <div class="capital-values">{{ formattedTotalAmount }}</div>
      <div class="value-change" :class="{ 'positive': isPositiveChange, 'negative': !isPositiveChange }">
        <span>{{ monthlyChange.percentage }}% за все время</span>
        <!-- <span>({{ monthlyChange.absolute.toFixed(2) }} RUB) за месяц</span> -->
      </div>
    </div>

    <p>Инвестировано: {{ formattedInvestedAmount }}</p>

  </div>
</template>

<style scoped>
.widget {
  grid-row: span 1;
  grid-column: span 1;

  background-color: #fff;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 4px 10px rgba(0,0,0,0.05);
}

.capital-value-with-change {
  margin: 15px 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.value-change.positive {
  color: var(--positiveColor);
}
.value-change.negative {
  color: var(--negativeColor);
}
</style>